/**
 * ä¸­å›½èŠ‚æ—¥æ•°æ®å’Œå·¥å…·å‡½æ•°
 */

// 2025å¹´ä¸­å›½æ³•å®šèŠ‚å‡æ—¥å’Œé‡è¦èŠ‚æ—¥æ•°æ®
export const chineseHolidays2025 = [
  // æ³•å®šèŠ‚å‡æ—¥
  { date: '2025-01-01', name: 'å…ƒæ—¦', type: 'legal', isWorkday: false },
  { date: '2025-01-28', name: 'æ˜¥èŠ‚å‰å¤œ', type: 'legal', isWorkday: false },
  { date: '2025-01-29', name: 'æ˜¥èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-01-30', name: 'æ˜¥èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-01-31', name: 'æ˜¥èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-02-01', name: 'æ˜¥èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-02-02', name: 'æ˜¥èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-04-05', name: 'æ¸…æ˜ŽèŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-04-06', name: 'æ¸…æ˜ŽèŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-04-07', name: 'æ¸…æ˜ŽèŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-05-01', name: 'åŠ³åŠ¨èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-05-02', name: 'åŠ³åŠ¨èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-05-03', name: 'åŠ³åŠ¨èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-05-04', name: 'åŠ³åŠ¨èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-05-05', name: 'åŠ³åŠ¨èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-05-31', name: 'ç«¯åˆèŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-06-02', name: 'ç«¯åˆèŠ‚', type: 'legal', isWorkday: false },
  
  // å½“å‰å’Œå³å°†åˆ°æ¥çš„èŠ‚æ—¥ï¼ˆä¾¿äºŽæµ‹è¯•ï¼‰
  { date: '2025-08-29', name: 'æµ‹è¯•èŠ‚æ—¥', type: 'legal', isWorkday: false },
  { date: '2025-08-30', name: 'æµ‹è¯•ä¼ ç»ŸèŠ‚', type: 'traditional', isWorkday: true },
  { date: '2025-09-01', name: 'å¼€å­¦æ—¥', type: 'traditional', isWorkday: true },
  { date: '2025-09-07', name: 'ä¸­ç§‹èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-09-10', name: 'æ•™å¸ˆèŠ‚', type: 'traditional', isWorkday: true },
  { date: '2025-10-01', name: 'å›½åº†èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-10-02', name: 'å›½åº†èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-10-03', name: 'å›½åº†èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-10-04', name: 'å›½åº†èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-10-05', name: 'å›½åº†èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-10-06', name: 'å›½åº†èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-10-07', name: 'å›½åº†èŠ‚', type: 'legal', isWorkday: false },
  { date: '2025-10-08', name: 'å›½åº†èŠ‚', type: 'legal', isWorkday: false },

  // è°ƒä¼‘å·¥ä½œæ—¥
  { date: '2025-01-26', name: 'æ˜¥èŠ‚è°ƒä¼‘', type: 'workday', isWorkday: true },
  { date: '2025-02-08', name: 'æ˜¥èŠ‚è°ƒä¼‘', type: 'workday', isWorkday: true },
  { date: '2025-04-27', name: 'åŠ³åŠ¨èŠ‚è°ƒä¼‘', type: 'workday', isWorkday: true },
  { date: '2025-09-28', name: 'å›½åº†èŠ‚è°ƒä¼‘', type: 'workday', isWorkday: true },
  { date: '2025-10-11', name: 'å›½åº†èŠ‚è°ƒä¼‘', type: 'workday', isWorkday: true },

  // ä¼ ç»ŸèŠ‚æ—¥
  { date: '2025-02-14', name: 'æƒ…äººèŠ‚', type: 'traditional', isWorkday: true },
  { date: '2025-03-08', name: 'å¦‡å¥³èŠ‚', type: 'traditional', isWorkday: true },
  { date: '2025-03-12', name: 'æ¤æ ‘èŠ‚', type: 'traditional', isWorkday: true },
  { date: '2025-04-01', name: 'æ„šäººèŠ‚', type: 'traditional', isWorkday: true },
  { date: '2025-05-04', name: 'é’å¹´èŠ‚', type: 'traditional', isWorkday: true },
  { date: '2025-05-11', name: 'æ¯äº²èŠ‚', type: 'traditional', isWorkday: true },
  { date: '2025-06-01', name: 'å„¿ç«¥èŠ‚', type: 'traditional', isWorkday: true },
  { date: '2025-06-15', name: 'çˆ¶äº²èŠ‚', type: 'traditional', isWorkday: true },
  { date: '2025-08-07', name: 'ä¸ƒå¤•èŠ‚', type: 'traditional', isWorkday: true },
  { date: '2025-09-10', name: 'æ•™å¸ˆèŠ‚', type: 'traditional', isWorkday: true },
  { date: '2025-10-31', name: 'ä¸‡åœ£èŠ‚', type: 'traditional', isWorkday: true },
  { date: '2025-12-24', name: 'å¹³å®‰å¤œ', type: 'traditional', isWorkday: true },
  { date: '2025-12-25', name: 'åœ£è¯žèŠ‚', type: 'traditional', isWorkday: true }
]

// èŠ‚æ—¥ç±»åž‹é…ç½®
export const holidayTypes = {
  legal: {
    name: 'æ³•å®šèŠ‚å‡æ—¥',
    color: '#f56c6c',
    backgroundColor: '#fef0f0',
    icon: 'ðŸŽ‰',
    priority: 1
  },
  workday: {
    name: 'è°ƒä¼‘å·¥ä½œæ—¥',
    color: '#e6a23c',
    backgroundColor: '#fdf6ec',
    icon: 'ðŸ’¼',
    priority: 2
  },
  traditional: {
    name: 'ä¼ ç»ŸèŠ‚æ—¥',
    color: '#909399',
    backgroundColor: '#f4f4f5',
    icon: 'ðŸ®',
    priority: 3
  }
}

/**
 * èŽ·å–æŒ‡å®šæ—¥æœŸçš„èŠ‚æ—¥ä¿¡æ¯
 * @param {Date|string} date æ—¥æœŸ
 * @returns {Object|null} èŠ‚æ—¥ä¿¡æ¯æˆ–null
 */
export function getHolidayInfo(date) {
  const dateString = formatDateString(date)
  return chineseHolidays2025.find(holiday => holiday.date === dateString) || null
}

/**
 * èŽ·å–æŒ‡å®šæœˆä»½çš„æ‰€æœ‰èŠ‚æ—¥
 * @param {number} year å¹´ä»½
 * @param {number} month æœˆä»½ (1-12)
 * @returns {Array} èŠ‚æ—¥åˆ—è¡¨
 */
export function getHolidaysForMonth(year, month) {
  const monthString = `${year}-${month.toString().padStart(2, '0')}`
  return chineseHolidays2025.filter(holiday => holiday.date.startsWith(monthString))
}

/**
 * èŽ·å–æŒ‡å®šå¹´ä»½çš„æ‰€æœ‰èŠ‚æ—¥
 * @param {number} year å¹´ä»½
 * @returns {Array} èŠ‚æ—¥åˆ—è¡¨
 */
export function getHolidaysForYear(year) {
  const yearString = year.toString()
  return chineseHolidays2025.filter(holiday => holiday.date.startsWith(yearString))
}

/**
 * æ£€æŸ¥æŒ‡å®šæ—¥æœŸæ˜¯å¦ä¸ºèŠ‚å‡æ—¥
 * @param {Date|string} date æ—¥æœŸ
 * @returns {boolean} æ˜¯å¦ä¸ºèŠ‚å‡æ—¥
 */
export function isHoliday(date) {
  const holiday = getHolidayInfo(date)
  return holiday && holiday.type === 'legal' && !holiday.isWorkday
}

/**
 * æ£€æŸ¥æŒ‡å®šæ—¥æœŸæ˜¯å¦ä¸ºå·¥ä½œæ—¥
 * @param {Date|string} date æ—¥æœŸ
 * @returns {boolean} æ˜¯å¦ä¸ºå·¥ä½œæ—¥
 */
export function isWorkday(date) {
  const holiday = getHolidayInfo(date)
  if (holiday) {
    return holiday.isWorkday
  }
  
  // å¦‚æžœæ²¡æœ‰ç‰¹æ®ŠèŠ‚æ—¥ï¼ŒæŒ‰æ­£å¸¸å·¥ä½œæ—¥åˆ¤æ–­ï¼ˆå‘¨ä¸€åˆ°å‘¨äº”ï¼‰
  const dateObj = new Date(date)
  const dayOfWeek = dateObj.getDay()
  return dayOfWeek >= 1 && dayOfWeek <= 5
}

/**
 * æ ¼å¼åŒ–æ—¥æœŸä¸ºå­—ç¬¦ä¸²
 * @param {Date|string} date æ—¥æœŸ
 * @returns {string} YYYY-MM-DDæ ¼å¼å­—ç¬¦ä¸²
 */
function formatDateString(date) {
  const dateObj = typeof date === 'string' ? new Date(date) : date
  return dateObj.toISOString().split('T')[0]
}

/**
 * èŽ·å–èŠ‚æ—¥æ˜¾ç¤ºæ ·å¼
 * @param {string} type èŠ‚æ—¥ç±»åž‹
 * @returns {Object} æ ·å¼å¯¹è±¡
 */
export function getHolidayStyle(type) {
  return holidayTypes[type] || holidayTypes.traditional
}

/**
 * èŽ·å–å³å°†åˆ°æ¥çš„èŠ‚æ—¥
 * @param {number} days æœªæ¥å¤©æ•°ï¼Œé»˜è®¤30å¤©
 * @returns {Array} å³å°†åˆ°æ¥çš„èŠ‚æ—¥åˆ—è¡¨
 */
export function getUpcomingHolidays(days = 30) {
  const today = new Date()
  const futureDate = new Date(today.getTime() + days * 24 * 60 * 60 * 1000)
  
  return chineseHolidays2025.filter(holiday => {
    const holidayDate = new Date(holiday.date)
    return holidayDate >= today && holidayDate <= futureDate
  }).sort((a, b) => new Date(a.date) - new Date(b.date))
}